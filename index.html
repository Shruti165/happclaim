<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File a Complaint - HappyClaim</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="static/css/common.css">
    <link rel="stylesheet" href="static/css/navigation.css">
    <style>
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
            padding: 0 20px;
        }

        .step-indicator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 3px;
            background-color: #e9ecef;
            z-index: 1;
            transform: translateY(-50%);
        }

        .step {
            width: auto;
            min-width: 140px;
            height: 45px;
            background-color: white;
            border: 2px solid #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
            border-radius: 25px;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .step:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .step.active {
            border-color: var(--secondary-color);
            background-color: var(--secondary-color);
            color: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .step.completed {
            border-color: var(--secondary-color);
            background-color: var(--secondary-color);
            color: white;
        }

        .step.completed::after {
            content: '✓';
            margin-left: 8px;
            font-size: 14px;
        }

        .step-label {
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            white-space: nowrap;
            letter-spacing: 0.3px;
        }

        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding: 0 20px;
        }

        @media (max-width: 1200px) {
            .step {
                min-width: 120px;
                padding: 0 15px;
            }
        }

        @media (max-width: 992px) {
            .step-indicator {
                flex-direction: column;
                align-items: flex-start;
                padding: 0;
            }

            .step-indicator::before {
                display: none;
            }

            .step {
                margin-bottom: 15px;
                width: 100%;
                justify-content: flex-start;
                padding-left: 25px;
                min-width: auto;
            }

            .step::before {
                content: '';
                position: absolute;
                left: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 8px;
                height: 8px;
                border-radius: 50%;
                background-color: #e9ecef;
            }

            .step.active::before,
            .step.completed::before {
                background-color: white;
            }
        }

        @media (max-width: 576px) {
            .step {
                height: 40px;
                padding-left: 20px;
            }

            .step-label {
                font-size: 0.85rem;
            }
        }

        /* Improved dropdown styles */
        .form-control {
            white-space: normal;
            overflow: visible;
            text-overflow: unset;
            min-height: 38px;
            padding: 8px 12px;
        }

        select.form-control {
            padding-right: 30px;
            background-color: white;
            cursor: pointer;
        }

        /* Custom dropdown styling */
        .form-group select {
            width: 100%;
            max-width: 100%;
            min-width: 200px;
            height: auto;
        }

        /* Ensure dropdown options are fully visible */
        select.form-control option {
            white-space: normal;
            padding: 8px 12px;
            min-height: 30px;
            line-height: 1.5;
            word-wrap: break-word;
        }

        /* Custom select wrapper for better control */
        .select-wrapper {
            position: relative;
            width: 100%;
        }

        .select-wrapper::after {
            content: '\f078';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            color: #6c757d;
        }

        /* Ensure dropdowns are visible over other elements */
        select.form-control {
            z-index: 1;
        }

        /* Improve dropdown appearance */
        .form-control:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        /* Make sure tooltips don't interfere with dropdowns */
        .tooltip {
            z-index: 1050;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .form-group select {
                min-width: 100%;
            }
        }

        /* Ensure long text in dropdowns is visible */
        .dropdown-menu {
            max-width: 100%;
            min-width: 200px;
            width: 100%;
        }

        .dropdown-item {
            white-space: normal;
            word-wrap: break-word;
            padding: 8px 12px;
        }

        /* Improve Select2 styling */
        .select2-container {
            width: 100% !important;
        }

        .select2-container--default .select2-selection--single {
            height: auto;
            min-height: 38px;
            border: 1px solid #ced4da;
            border-radius: 4px;
        }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            line-height: 1.5;
            padding: 8px 12px;
            white-space: normal;
            word-wrap: break-word;
        }

        .select2-container--default .select2-selection--single .select2-selection__arrow {
            height: 36px;
        }

        .select2-dropdown {
            border: 1px solid #ced4da;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            width: 100% !important;
        }

        .select2-container--default .select2-results__option {
            padding: 8px 12px;
            white-space: normal;
            word-wrap: break-word;
        }

        .select2-container--default .select2-results__option--highlighted[aria-selected] {
            background-color: var(--secondary-color);
        }

        /* Section styling improvements */
        .form-section {
            margin-bottom: 30px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .card {
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .card-header {
            background-color: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            padding: 15px 20px;
        }

        .card-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            font-weight: 500;
            margin-bottom: 8px;
            color: #495057;
        }

        /* Improve table styling */
        .table {
            margin-bottom: 0;
        }

        .table th {
            background-color: #f8f9fa;
            font-weight: 600;
            white-space: nowrap;
        }

        .table td {
            vertical-align: middle;
        }

        /* Improve button styling */
        .btn {
            padding: 8px 16px;
            font-weight: 500;
            border-radius: 4px;
        }

        .btn-primary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }

        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }

        /* Improve alert styling */
        .alert {
            border-radius: 4px;
            padding: 12px 16px;
            margin-bottom: 20px;
        }

        /* Improve modal styling */
        .modal-content {
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .modal-header {
            background-color: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        /* Improve chat window styling */
        .chat-messages {
                padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }

        .message {
            margin-bottom: 10px;
        }

        .user-message .bg-primary {
            border-radius: 12px 12px 0 12px;
        }

        .lawyer-message .bg-light {
            border-radius: 12px 12px 12px 0;
        }

        /* Improve payment section styling */
        .payment-summary {
            background-color: #f8f9fa;
                padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .payment-summary h4 {
            margin-bottom: 15px;
            color: #495057;
        }

        .payment-summary p {
            margin-bottom: 8px;
            color: #6c757d;
        }

        .payment-summary h5 {
            margin-top: 15px;
            color: #212529;
        }
    </style>

    <!-- Add Select2 CSS and JS -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>
<body>
<div class="d-flex">
    <!-- Include Navigation -->
    <div id="navigation"></div>

    <div class="content">
        <div class="container mt-4">
            <h1>File a Complaint</h1>
            <p class="lead text-center mb-4">Help us help you resolve your consumer issues</p>

            <!-- Progress Indicator -->
            <div class="step-indicator">
                <div class="step active" data-step="1">
                    <span class="step-label">Complainant Details</span>
                </div>
                <div class="step" data-step="2">
                    <span class="step-label">Complaint Details</span>
                </div>
                <div class="step" data-step="3">
                    <span class="step-label">Respondent Details</span>
                </div>
                <div class="step" data-step="4">
                    <span class="step-label">Jurisdiction</span>
                </div>
                <div class="step" data-step="5">
                    <span class="step-label">Lawyer Selection</span>
                </div>
                <div class="step" data-step="6">
                    <span class="step-label">Confirmation</span>
                </div>
                <div class="step" data-step="7">
                    <span class="step-label">Payment</span>
                </div>
            </div>

            <form id="complaintForm">
                <!-- Section 1: Complainant Details -->
                <div class="form-section active" id="section-1">
                    <div class="card">
                        <div class="card-header">
                            <h3>Complainant Details</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label for="complainant-name" data-toggle="tooltip" title="Enter your full name as per official documents">
                                    Name of Complainant <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <input type="text" class="form-control" id="complainant-name" required>
                            </div>
                            <div class="form-group">
                                <label for="pincode" data-toggle="tooltip" title="Select your pincode to automatically fill city and state">
                                    Pincode <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <select class="form-control" id="pincode" required>
                                    <option value="">Select Pincode</option>
                                    <option value="400001">400001 - Mumbai, Maharashtra</option>
                                    <option value="110001">110001 - New Delhi, Delhi</option>
                                    <option value="560001">560001 - Bangalore, Karnataka</option>
                                    <option value="600001">600001 - Chennai, Tamil Nadu</option>
                                    <option value="700001">700001 - Kolkata, West Bengal</option>
                                    <option value="380001">380001 - Ahmedabad, Gujarat</option>
                                    <option value="500001">500001 - Hyderabad, Telangana</option>
                                    <option value="411001">411001 - Pune, Maharashtra</option>
                                    <option value="302001">302001 - Jaipur, Rajasthan</option>
                                    <option value="800001">800001 - Patna, Bihar</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="complainant-address" data-toggle="tooltip" title="Enter your complete communication address where you can receive official correspondence">
                                    Communication Address of Complainant <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <textarea class="form-control" id="complainant-address" rows="3" required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="phone" data-toggle="tooltip" title="Enter your 10-digit mobile number">
                                    Phone No <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <input type="tel" class="form-control" id="phone" pattern="[0-9]{10}" required>
                                <small class="form-text text-muted">Enter 10-digit mobile number</small>
                            </div>
                            <div class="form-group">
                                <label for="email" data-toggle="tooltip" title="Enter your email address for official communication">
                                    Email <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <input type="email" class="form-control" id="email" required>
                            </div>
                            <div class="form-group">
                                <label for="relationship" data-toggle="tooltip" title="Select your relationship with the complainant">
                                    Relationship with Complainant <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <select class="form-control" id="relationship" required>
                                    <option value="">Select Relationship</option>
                                    <option value="self">Self</option>
                                    <option value="mother">Mother</option>
                                    <option value="father">Father</option>
                                    <option value="brother">Brother</option>
                                    <option value="sister">Sister</option>
                                    <option value="husband">Husband</option>
                                    <option value="son">Son</option>
                                    <option value="daughter">Daughter</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Complaint Details -->
                <div class="form-section" id="section-2">
                    <div class="card">
                        <div class="card-header">
                            <h3>Complaint Details</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label for="industry" data-toggle="tooltip" title="Select the industry related to your complaint">
                                    Industry <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <select class="form-control" id="industry" required>
                                    <option value="">Select Industry</option>
                                    <option value="retail">Retail</option>
                                    <option value="hospitality">Hospitality</option>
                                    <option value="finance">Finance</option>
                                    <option value="healthcare">Healthcare</option>
                                    <option value="real_estate">Real Estate</option>
                                    <option value="transportation">Transportation</option>
                                    <option value="telecom">Telecommunications</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label data-toggle="tooltip" title="Select whether your complaint is related to a product or service">
                                    Service Type <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" id="serviceTypeProduct" name="serviceType" class="custom-control-input" value="product" required>
                                    <label class="custom-control-label" for="serviceTypeProduct">Product</label>
                                </div>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" id="serviceTypeService" name="serviceType" class="custom-control-input" value="service">
                                    <label class="custom-control-label" for="serviceTypeService">Service</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="category" data-toggle="tooltip" title="Select the category that best describes your complaint">
                                    Category <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <select class="form-control" id="category" required>
                                    <option value="">Select Category</option>
                                    <option value="travel">Travel</option>
                                    <option value="healthcare">Healthcare</option>
                                    <option value="ecommerce">E-commerce</option>
                                    <option value="banking">Banking</option>
                                    <option value="insurance">Insurance</option>
                                    <option value="real_estate">Real Estate</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="subcategory" data-toggle="tooltip" title="Select the specific type of complaint">
                                    Sub-Category <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <select class="form-control" id="subcategory" required>
                                    <option value="">Select Sub-Category</option>
                                    <!-- Sub-categories will be populated dynamically -->
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="issueTitle" data-toggle="tooltip" title="Enter a brief title for your complaint">
                                    Issue Title <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <input type="text" class="form-control" id="issueTitle" required>
                            </div>

                            <div class="form-group">
                                <label for="description" data-toggle="tooltip" title="Provide detailed information about your complaint">
                                    Complaint Description <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <textarea class="form-control" id="description" rows="5" required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="value" data-toggle="tooltip" title="Enter the monetary value of the product or service">
                                    Value of Product/Service (₹) <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">₹</span>
                                    </div>
                                    <input type="number" class="form-control" id="value" min="0" step="0.01" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="documents" data-toggle="tooltip" title="Upload relevant documents to support your complaint">
                                    Upload Documents (Bills, Proofs, Communication, etc.) <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <div class="custom-file">
                                    <input type="file" class="custom-file-input" id="documents" multiple>
                                    <label class="custom-file-label" for="documents">Choose files</label>
                                </div>
                                <small class="form-text text-muted">Supported formats: PDF, JPG, PNG (Max size: 5MB each)</small>
                                <div id="uploadedFiles" class="mt-3">
                                    <!-- Uploaded files will be listed here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 3: Respondent Details -->
                <div class="form-section" id="section-3">
                    <div class="card">
                        <div class="card-header">
                            <h3>Respondent Details (Opposite Parties Involved)</h3>
                        </div>
                        <div class="card-body">
                            <form id="respondentForm">
                                <div class="form-group">
                                    <label for="partyName" data-toggle="tooltip" title="Enter the name of the opposite party">
                                        Name of Party <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <input type="text" class="form-control" id="partyName" required>
                                </div>
                                <div class="form-group">
                                    <label for="partyAddress" data-toggle="tooltip" title="Enter the complete address of the opposite party">
                                        Address of Party <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <textarea class="form-control" id="partyAddress" rows="3" required></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="partyRelationship" data-toggle="tooltip" title="Select the relationship with the respondent">
                                        Relationship with Respondent <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <select class="form-control" id="partyRelationship" required>
                                        <option value="">Select Relationship</option>
                                        <option value="individual">Individual</option>
                                        <option value="company">Company/Organization</option>
                                        <option value="government">Government Department</option>
                                        <option value="service_provider">Service Provider</option>
                                        <option value="manufacturer">Manufacturer</option>
                                        <option value="retailer">Retailer</option>
                                        <option value="distributor">Distributor</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="partyContact" data-toggle="tooltip" title="Enter the contact number of the opposite party (optional)">
                                        Contact No <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <input type="tel" class="form-control" id="partyContact">
                                </div>
                                <div class="form-group">
                                    <label for="partyEmail" data-toggle="tooltip" title="Enter the email address of the opposite party (optional)">
                                        Email <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <input type="email" class="form-control" id="partyEmail">
                                </div>
                                <div class="form-group">
                                    <button type="button" class="btn btn-primary" id="addParty">
                                        <i class="fas fa-plus"></i> Add Party
                                    </button>
                                    <button type="button" class="btn btn-secondary" id="updateParty" style="display: none;">
                                        <i class="fas fa-edit"></i> Update Party
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary" id="cancelEdit" style="display: none;">
                                        <i class="fas fa-times"></i> Cancel
                                    </button>
                                </div>
                            </form>

                            <div class="table-responsive mt-4">
                                <table class="table table-bordered table-hover" id="partiesTable">
                                    <thead class="thead-light">
                                        <tr>
                                            <th>Name</th>
                                            <th>Address</th>
                                            <th>Relationship</th>
                                            <th>Contact</th>
                                            <th>Email</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Parties will be added here dynamically -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 4: Jurisdiction Details -->
                <div class="form-section" id="section-4">
                    <div class="card">
                        <div class="card-header">
                            <h3>Jurisdiction Details - District Consumer Disputes Redressal Forum (DCDRC)</h3>
                        </div>
                        <div class="card-body">
                            <!-- Jurisdiction Information -->
                            <div class="alert alert-info mb-4">
                                <h5 class="alert-heading">Under the Consumer Protection Act, 2019:</h5>
                                <ul class="mb-0">
                                    <li><strong>District Commission (DCDRC):</strong> For claims up to ₹1 crore.</li>
                                    <li><strong>State Commission (SCDRC):</strong> For claims exceeding ₹1 crore but not exceeding ₹10 crore.</li>
                                    <li><strong>National Commission (NCDRC):</strong> For claims exceeding ₹10 crore.</li>
                                </ul>
                            </div>

                            <form id="jurisdictionForm">
                                <div class="form-group">
                                    <label for="jurisdictionPincode" data-toggle="tooltip" title="Pincode of the jurisdiction area">
                                        Pincode <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <select class="form-control" id="jurisdictionPincode" required>
                                        <option value="">Select Pincode</option>
                                        <option value="400001">400001 - Mumbai, Maharashtra</option>
                                        <option value="110001">110001 - New Delhi, Delhi</option>
                                        <option value="560001">560001 - Bangalore, Karnataka</option>
                                        <option value="600001">600001 - Chennai, Tamil Nadu</option>
                                        <option value="700001">700001 - Kolkata, West Bengal</option>
                                        <option value="380001">380001 - Ahmedabad, Gujarat</option>
                                        <option value="500001">500001 - Hyderabad, Telangana</option>
                                        <option value="411001">411001 - Pune, Maharashtra</option>
                                        <option value="302001">302001 - Jaipur, Rajasthan</option>
                                        <option value="800001">800001 - Patna, Bihar</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="districtCourt" data-toggle="tooltip" title="Name of the District Consumer Court">
                                        District Court <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <input type="text" class="form-control" id="districtCourt" required>
                                </div>
                                <div class="form-group">
                                    <label for="jurisdictionCity" data-toggle="tooltip" title="City of the jurisdiction">
                                        City <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <input type="text" class="form-control" id="jurisdictionCity" required>
                                </div>
                                <div class="form-group">
                                    <label for="courtAddress" data-toggle="tooltip" title="Complete address of the District Consumer Court">
                                        Court Address <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <textarea class="form-control" id="courtAddress" rows="3" required></textarea>
                                </div>
                                <div class="form-group">
                                    <button type="button" class="btn btn-primary" id="confirmJurisdiction">
                                        <i class="fas fa-check"></i> Confirm Jurisdiction Details
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Section 5: Lawyer Selection -->
                <div class="form-section" id="section-5">
                    <!-- Advocate Selection Card -->
                    <div class="card mb-4">
                        <div class="card-header">
                            <h3>Advocate Selection</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label data-toggle="tooltip" title="Choose whether to select your own lawyer or let Happy Claim suggest one">
                                    Select your preferred way to choose a lawyer <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <div class="custom-control custom-radio">
                                    <input type="radio" id="ownCounsel" name="advocateSelection" class="custom-control-input" value="own" checked>
                                    <label class="custom-control-label" for="ownCounsel">Select own counsel</label>
                                </div>
                                <div class="custom-control custom-radio">
                                    <input type="radio" id="suggestCounsel" name="advocateSelection" class="custom-control-input" value="suggest">
                                    <label class="custom-control-label" for="suggestCounsel">Allow Happy Claim to suggest</label>
                                </div>
                            </div>

                            <!-- Lawyer Selection Dropdown (Initially Visible) -->
                            <div class="form-group mt-3" id="lawyerDropdownSection">
                                <label for="lawyerSelect" data-toggle="tooltip" title="Select a lawyer from the list">
                                    Select Lawyer <i class="fas fa-info-circle text-muted"></i>
                                </label>
                                <select class="form-control" id="lawyerSelect">
                                    <option value="">Select a Lawyer</option>
                                    <option value="1">Adv. Rajesh Kumar (10 years, Specialist in Consumer Law)</option>
                                    <option value="2">Adv. Priya Sharma (8 years, Specialist in Consumer Protection)</option>
                                    <option value="3">Adv. Amit Singh (12 years, Specialist in Consumer Law)</option>
                                    <option value="4">Adv. Neha Gupta (9 years, Specialist in Consumer Protection)</option>
                                    <option value="5">Adv. Vikram Patel (11 years, Specialist in Consumer Disputes)</option>
                                    <option value="6">Adv. Meera Desai (7 years, Specialist in Consumer Rights)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Lawyer Details Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Lawyer Details</h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4 text-center">
                                    <img id="lawyerPhoto" src="https://randomuser.me/api/portraits/men/1.jpg" alt="Lawyer Photo" class="img-fluid rounded-circle mb-3" style="width: 200px; height: 200px; object-fit: cover;">
                                    <h4 id="lawyerFullName" class="mb-3">Adv. Rajesh Kumar</h4>
                                </div>
                                <div class="col-md-8">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h5>Professional Details</h5>
                                            <p><strong>Specialization:</strong> <span id="lawyerSpecialization">Specialist in Consumer Law</span></p>
                                            <p><strong>Credentials:</strong> <span id="lawyerCredentials">LL.M, Bar Council of India</span></p>
                                            <p><strong>Experience:</strong> <span id="lawyerExperience">10 years</span></p>
                                            <p><strong>Success Rate:</strong> <span id="lawyerSuccessRate">85%</span></p>
                                            <p><strong>Cases Handled:</strong> <span id="lawyerCasesHandled">250+</span></p>
                                            <p><strong>Languages:</strong> <span id="lawyerLanguages">English, Hindi, Marathi</span></p>
                                        </div>
                                        <div class="col-md-6">
                                            <h5>Performance Metrics</h5>
                                            <div class="mb-3">
                                                <p><strong>Customer Rating:</strong></p>
                                                <div id="customerRating" class="mb-2">
                                                    <i class="fas fa-star text-warning"></i>
                                                    <i class="fas fa-star text-warning"></i>
                                                    <i class="fas fa-star text-warning"></i>
                                                    <i class="fas fa-star text-warning"></i>
                                                    <i class="fas fa-star-half-alt text-warning"></i>
                                                    <span class="ml-2">4.5/5</span>
                                                </div>
                                                <small class="text-muted">Based on client feedback</small>
                                            </div>
                                            <div class="mb-3">
                                                <p><strong>HappyClaim Rating:</strong></p>
                                                <div id="happyClaimRating" class="mb-2">
                                                    <i class="fas fa-star text-warning"></i>
                                                    <i class="fas fa-star text-warning"></i>
                                                    <i class="fas fa-star text-warning"></i>
                                                    <i class="fas fa-star text-warning"></i>
                                                    <i class="fas fa-star text-warning"></i>
                                                    <span class="ml-2">4.8/5</span>
                                                </div>
                                                <small class="text-muted">Based on response time and case handling</small>
                                            </div>
                                            <p><strong>Average Response Time:</strong> <span id="lawyerResponseTime">Within 2 hours</span></p>
                                        </div>
                                    </div>
                                    <div class="mt-4">
                                        <button type="button" class="btn btn-primary mr-2" id="connectLawyer">
                                            <i class="fas fa-phone"></i> Connect With Lawyer
                                        </button>
                                        <button type="button" class="btn btn-success" id="chatLawyer">
                                            <i class="fas fa-comments"></i> Chat with Lawyer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Window Modal -->
                <div class="modal fade" id="chatModal" tabindex="-1" role="dialog" aria-labelledby="chatModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="chatModalLabel">Chat with Adv. Rajesh Kumar</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="chat-messages" id="chatMessages" style="height: 300px; overflow-y: auto;">
                                    <div class="message lawyer-message mb-2">
                                        <div class="d-flex">
                                            <div class="bg-light p-2 rounded">
                                                Hello! How can I help you with your consumer complaint?
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group mt-3">
                                    <input type="text" class="form-control" id="chatInput" placeholder="Type your message...">
                                    <div class="input-group-append">
                                        <button class="btn btn-primary" type="button" id="sendMessage">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 6: Confirmation -->
                <div class="form-section" id="section-6">
                    <div class="card">
                        <div class="card-header">
                            <h3>Confirmation</h3>
                        </div>
                        <div class="card-body">
                            <div class="summary">
                                <h4>Please review your complaint details:</h4>
                                <div id="summary-details"></div>
                            </div>

                            <!-- Disclaimer Message -->
                            <div class="alert alert-warning mt-4">
                                <i class="fas fa-exclamation-triangle mr-2"></i>
                                <strong>Disclaimer:</strong> We at HappyClaim are not responsible to check validity of information filled by user for complaint raised.
                            </div>

                            <div class="form-group mt-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="terms" required>
                                    <label class="form-check-label" for="terms">
                                        I confirm that all the information provided is true and accurate to the best of my knowledge.
                                    </label>
                                </div>
                            </div>

                            <div class="form-group mt-4">
                                <button type="button" class="btn btn-primary" id="confirmDetails">
                                    <i class="fas fa-check-circle"></i> Confirm Details
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 7: Payment -->
                <div class="form-section" id="section-7">
                    <div class="card">
                        <div class="card-header">
                            <h3>Payment Details</h3>
                        </div>
                        <div class="card-body">
                            <form id="paymentForm">
                                <!-- Case ID Field -->
                                <div class="form-group">
                                    <label for="caseId" data-toggle="tooltip" title="Your unique case identification number">
                                        Case ID <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <input type="text" class="form-control" id="caseId" readonly>
                                </div>

                                <div class="payment-summary mb-4">
                                    <h4>Payment Summary</h4>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <p>Filing Fee: ₹500</p>
                                            <p>Lawyer Fee: ₹2000</p>
                                            <p>Service Tax: ₹300</p>
                                            <h5>Total Amount: ₹2800</h5>
                                </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="payment-method" data-toggle="tooltip" title="Select your preferred payment method">
                                        Payment Mode <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <select class="form-control" id="payment-method" required>
                                        <option value="">Select Payment Method</option>
                                        <option value="credit">Credit Card</option>
                                        <option value="debit">Debit Card</option>
                                        <option value="netbanking">Net Banking</option>
                                        <option value="upi">UPI</option>
                                        <option value="wallet">Digital Wallet</option>
                                </select>
                                </div>

                                <div class="form-group">
                                    <label for="transactionId" data-toggle="tooltip" title="Enter the transaction ID provided by your payment method">
                                        Transaction ID <i class="fas fa-info-circle text-muted"></i>
                                    </label>
                                    <input type="text" class="form-control" id="transactionId" placeholder="Enter transaction ID" required>
                                </div>

                                <div class="form-group mt-4">
                                    <button type="button" class="btn btn-primary" id="makePayment">
                                        <i class="fas fa-lock"></i> Make Payment
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="form-navigation">
                <button type="button" class="btn btn-outline-primary" id="prevBtn" style="display: none;">Previous</button>
                <button type="button" class="btn btn-primary" id="nextBtn">Next</button>
            </div>
        </form>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
    $(document).ready(function() {
        // Load navigation first
        $("#navigation").load("static/navigation.html", function(response, status, xhr) {
            if (status === "error") {
                console.error("Error loading navigation:", xhr.status, xhr.statusText);
                return;
            }
            
            // Initialize navigation after it's loaded
            $('.nav-link[href="file-complaint.html"]').addClass('active');
            
            // Initialize tooltips after navigation is loaded
            $('[data-toggle="tooltip"]').tooltip({
                placement: 'top',
                trigger: 'hover'
            });

            // Add mobile navigation toggle
            $('<button class="mobile-nav-toggle"><i class="fas fa-bars"></i></button>').insertAfter('.content');
            
            // Handle mobile navigation toggle
            $('.mobile-nav-toggle').on('click', function() {
                $('.sidebar').toggleClass('active');
            });
        });

        // Pincode change handler
        $('#pincode').change(function() {
            const selectedOption = $(this).find('option:selected');
            if (selectedOption.val()) {
                const [pincode, cityState] = selectedOption.text().split(' - ');
                // Here you can add logic to auto-fill city and state if needed
                console.log(`Selected: ${cityState}`);
            }
        });

        // Phone number validation
        $('#phone').on('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '').substring(0, 10);
        });

        let currentSection = 1;
        const totalSections = 7;

        // Update progress indicator
        function updateProgress() {
            $('.step').removeClass('active completed');
            $('.step').each(function(index) {
                if (index + 1 < currentSection) {
                    $(this).addClass('completed');
                } else if (index + 1 === currentSection) {
                    $(this).addClass('active');
                }
            });
        }

        // Show/hide navigation buttons
        function updateButtons() {
            $('#prevBtn').toggle(currentSection > 1);
            $('#nextBtn').text(currentSection === totalSections ? 'Submit' : 'Next');
        }

        // Function to update summary details
        function updateSummary() {
            const summary = `
                <div class="row">
                    <div class="col-md-6">
                        <h5>Complainant Details</h5>
                        <p><strong>Name:</strong> ${$('#complainant-name').val()}</p>
                        <p><strong>Phone:</strong> ${$('#phone').val()}</p>
                        <p><strong>Email:</strong> ${$('#email').val()}</p>
                        <p><strong>Address:</strong> ${$('#complainant-address').val()}</p>
                    </div>
                    <div class="col-md-6">
                        <h5>Complaint Details</h5>
                        <p><strong>Category:</strong> ${$('#category option:selected').text()}</p>
                        <p><strong>Sub-Category:</strong> ${$('#subcategory option:selected').text()}</p>
                        <p><strong>Issue Title:</strong> ${$('#issueTitle').val()}</p>
                        <p><strong>Amount:</strong> ₹${$('#value').val()}</p>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-md-6">
                        <h5>Respondent Details</h5>
                        <div id="respondent-summary">
                            <!-- Respondent details will be populated here -->
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h5>Jurisdiction Details</h5>
                        <p><strong>District Court:</strong> ${$('#districtCourt').val()}</p>
                        <p><strong>City:</strong> ${$('#jurisdictionCity').val()}</p>
                        <p><strong>Address:</strong> ${$('#courtAddress').val()}</p>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-12">
                        <h5>Selected Lawyer</h5>
                        <p><strong>Name:</strong> ${$('#lawyerFullName').text()}</p>
                        <p><strong>Specialization:</strong> ${$('#lawyerSpecialization').text()}</p>
                        <p><strong>Credentials:</strong> ${$('#lawyerCredentials').text()}</p>
                    </div>
                </div>
            `;
            $('#summary-details').html(summary);
        }

        // Function to update respondent summary
        function updateRespondentSummary() {
            const $respondentSummary = $('#respondent-summary');
            $respondentSummary.empty();

            if (parties.length === 0) {
                $respondentSummary.append('<p>No respondents added</p>');
                return;
            }

            parties.forEach((party, index) => {
                $respondentSummary.append(`
                    <div class="mb-3">
                        <p><strong>Party ${index + 1}:</strong></p>
                        <p><strong>Name:</strong> ${party.name}</p>
                        <p><strong>Address:</strong> ${party.address}</p>
                        <p><strong>Relationship:</strong> ${party.relationship}</p>
                        ${party.contact ? `<p><strong>Contact:</strong> ${party.contact}</p>` : ''}
                        ${party.email ? `<p><strong>Email:</strong> ${party.email}</p>` : ''}
                    </div>
                `);
            });
        }

        // Handle next button click
        $('#nextBtn').on('click', function() {
            if (currentSection === totalSections) {
                // Submit form
                alert('Complaint submitted successfully!');
                window.location.href = 'complaint-history.html';
            } else {
                currentSection++;
                $('.form-section').removeClass('active');
                $(`#section-${currentSection}`).addClass('active');
                updateProgress();
                updateButtons();

                // Update specific sections when entering them
                if (currentSection === 6) { // When entering confirmation section
                    updateSummary();
                    updateRespondentSummary();
                } else if (currentSection === 7) { // When entering payment section
                    updatePaymentSection();
                }
            }
        });

        // Handle previous button click
        $('#prevBtn').on('click', function() {
            currentSection--;
            $('.form-section').removeClass('active');
            $(`#section-${currentSection}`).addClass('active');
            updateProgress();
            updateButtons();
        });

        // Remove validation from confirm buttons
        $('#confirmJurisdiction').on('click', function(e) {
            e.preventDefault();
            showAlert('Jurisdiction details confirmed successfully!', 'success');
        });

        $('#confirmDetails').on('click', function(e) {
            e.preventDefault();
            showAlert('Details confirmed successfully!', 'success');
        });

        // Sub-categories mapping
        const subCategories = {
            travel: [
                { value: 'hotel', label: 'Hotel Booking & Stay' },
                { value: 'travel_partner', label: 'Travel Agency & Tour Operator' },
                { value: 'airline', label: 'Airline Services' },
                { value: 'railway', label: 'Railway Services' },
                { value: 'bus', label: 'Bus Services' },
                { value: 'car_rental', label: 'Car Rental Services' },
                { value: 'cruise', label: 'Cruise Services' },
                { value: 'travel_insurance', label: 'Travel Insurance' },
                { value: 'visa', label: 'Visa Services' },
                { value: 'others', label: 'Other Travel Services' }
            ],
            healthcare: [
                { value: 'hospital', label: 'Hospital Services' },
                { value: 'clinic', label: 'Clinic Services' },
                { value: 'pharmacy', label: 'Pharmacy & Medicine' },
                { value: 'diagnostic', label: 'Diagnostic Services' },
                { value: 'health_insurance', label: 'Health Insurance' },
                { value: 'medical_equipment', label: 'Medical Equipment' },
                { value: 'dental', label: 'Dental Services' },
                { value: 'alternative_medicine', label: 'Alternative Medicine' },
                { value: 'nursing', label: 'Nursing Services' },
                { value: 'others', label: 'Other Healthcare Services' }
            ],
            ecommerce: [
                { value: 'delivery', label: 'Delivery & Shipping Issues' },
                { value: 'product_quality', label: 'Product Quality & Defects' },
                { value: 'refund', label: 'Refund Issues' },
                { value: 'return', label: 'Return & Exchange' },
                { value: 'pricing', label: 'Pricing Disputes' },
                { value: 'warranty', label: 'Warranty Claims' },
                { value: 'seller', label: 'Seller Behavior' },
                { value: 'payment', label: 'Payment Issues' },
                { value: 'account', label: 'Account Related Issues' },
                { value: 'others', label: 'Other E-commerce Issues' }
            ],
            banking: [
                { value: 'account', label: 'Account Related Issues' },
                { value: 'transaction', label: 'Transaction Issues' },
                { value: 'loan', label: 'Loan Services' },
                { value: 'credit_card', label: 'Credit Card Services' },
                { value: 'debit_card', label: 'Debit Card Services' },
                { value: 'net_banking', label: 'Net Banking Issues' },
                { value: 'mobile_banking', label: 'Mobile Banking Issues' },
                { value: 'atm', label: 'ATM Services' },
                { value: 'cheque', label: 'Cheque Related Issues' },
                { value: 'others', label: 'Other Banking Issues' }
            ],
            insurance: [
                { value: 'claim', label: 'Claim Settlement' },
                { value: 'policy', label: 'Policy Related Issues' },
                { value: 'premium', label: 'Premium Payment Issues' },
                { value: 'health_insurance', label: 'Health Insurance' },
                { value: 'life_insurance', label: 'Life Insurance' },
                { value: 'motor_insurance', label: 'Motor Insurance' },
                { value: 'travel_insurance', label: 'Travel Insurance' },
                { value: 'home_insurance', label: 'Home Insurance' },
                { value: 'documentation', label: 'Documentation Issues' },
                { value: 'others', label: 'Other Insurance Issues' }
            ],
            real_estate: [
                { value: 'builder', label: 'Builder Issues' },
                { value: 'property', label: 'Property Related Issues' },
                { value: 'rental', label: 'Rental Issues' },
                { value: 'broker', label: 'Broker Services' },
                { value: 'home_loan', label: 'Home Loan Issues' },
                { value: 'maintenance', label: 'Maintenance Issues' },
                { value: 'possession', label: 'Possession Delay' },
                { value: 'documentation', label: 'Documentation Issues' },
                { value: 'amenities', label: 'Amenities & Facilities' },
                { value: 'others', label: 'Other Real Estate Issues' }
            ]
        };

        // Update sub-categories when category changes
        $('#category').on('change', function() {
            const category = $(this).val();
            const $subcategory = $('#subcategory');
            
            // Clear existing options
            $subcategory.empty();
            $subcategory.append('<option value="">Select Sub-Category</option>');
            
            if (category && subCategories[category]) {
                subCategories[category].forEach(item => {
                    $subcategory.append(`<option value="${item.value}">${item.label}</option>`);
                });
            }
            
            // Reinitialize Select2 for subcategory
            $subcategory.select2('destroy').select2({
                width: '100%',
                dropdownAutoWidth: true
            });
        });

        // Initialize Select2 for all selects
        $('select').select2({
            width: '100%',
            dropdownAutoWidth: true
        });

        // Handle file uploads
        $('#documents').change(function() {
            const files = this.files;
            const $uploadedFiles = $('#uploadedFiles');
            
            $uploadedFiles.empty();
            
            if (files.length > 0) {
                const $list = $('<ul class="list-group"></ul>');
                
                Array.from(files).forEach(file => {
                    const $item = $(`
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>${file.name}</span>
                            <span class="badge badge-primary badge-pill">${formatFileSize(file.size)}</span>
                        </li>
                    `);
                    $list.append($item);
                });
                
                $uploadedFiles.append($list);
            }
        });

        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Store parties data
        let parties = [];
        let editingIndex = -1;

        // Add party button click handler
        $('#addParty').on('click', function(e) {
            e.preventDefault();
            console.log('Add Party button clicked');
            
            // Get form values
            const name = $('#partyName').val().trim();
            const address = $('#partyAddress').val().trim();
            const relationship = $('#partyRelationship').val();
            const contact = $('#partyContact').val().trim();
            const email = $('#partyEmail').val().trim();
            
            console.log('Form values:', { name, address, relationship, contact, email });
            
            // Validate required fields
            if (!name || !address || !relationship) {
                showAlert('Please fill in all required fields (Name, Address, and Relationship)', 'danger');
                return;
            }

            // Create new party object
            const party = {
                name: name,
                address: address,
                relationship: relationship,
                contact: contact,
                email: email
            };

            // Add to parties array
            parties.push(party);
            console.log('Added party:', party);
            console.log('Total parties:', parties.length);
            
            // Update table and clear form
            updatePartiesTable();
            clearForm();
            
            // Show success message
            showAlert('Party added successfully!', 'success');
        });

        // Function to update the parties table
        function updatePartiesTable() {
            console.log('Updating parties table');
            const $tbody = $('#partiesTable tbody');
            $tbody.empty();

            if (parties.length === 0) {
                $tbody.append(`
                    <tr>
                        <td colspan="6" class="text-center">No parties added yet</td>
                    </tr>
                `);
                return;
            }

            parties.forEach((party, index) => {
                const $row = $(`
                    <tr>
                        <td>${party.name}</td>
                        <td>${party.address}</td>
                        <td>${party.relationship}</td>
                        <td>${party.contact || '-'}</td>
                        <td>${party.email || '-'}</td>
                        <td>
                            <button class="btn btn-sm btn-info edit-party" data-index="${index}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger delete-party" data-index="${index}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `);

                $tbody.append($row);
            });

            // Add event handlers for edit and delete buttons
            $('.edit-party').on('click', function() {
                const index = $(this).data('index');
                editParty(index);
            });

            $('.delete-party').on('click', function() {
                const index = $(this).data('index');
                deleteParty(index);
            });
        }

        // Function to edit a party
        function editParty(index) {
            console.log('Editing party at index:', index);
            const party = parties[index];
            $('#partyName').val(party.name);
            $('#partyAddress').val(party.address);
            $('#partyRelationship').val(party.relationship);
            $('#partyContact').val(party.contact);
            $('#partyEmail').val(party.email);

            editingIndex = index;
            $('#addParty').hide();
            $('#updateParty').show();
            $('#cancelEdit').show();
        }

        // Update party button click handler
        $('#updateParty').on('click', function(e) {
            e.preventDefault();
            console.log('Update Party button clicked');
            
            if (editingIndex === -1) return;
            
            // Get form values
            const name = $('#partyName').val().trim();
            const address = $('#partyAddress').val().trim();
            const relationship = $('#partyRelationship').val();
            const contact = $('#partyContact').val().trim();
            const email = $('#partyEmail').val().trim();
            
            console.log('Updated values:', { name, address, relationship, contact, email });
            
            // Validate required fields
            if (!name || !address || !relationship) {
                showAlert('Please fill in all required fields (Name, Address, and Relationship)', 'danger');
                return;
            }

            // Update party object
            parties[editingIndex] = {
                name: name,
                address: address,
                relationship: relationship,
                contact: contact,
                email: email
            };

            console.log('Updated party:', parties[editingIndex]);
            
            // Update table and reset form
            updatePartiesTable();
            clearForm();
            resetButtons();
            
            // Show success message
            showAlert('Party updated successfully!', 'success');
        });

        // Cancel edit button click handler
        $('#cancelEdit').on('click', function(e) {
            e.preventDefault();
            console.log('Cancel edit clicked');
            clearForm();
            resetButtons();
        });

        // Function to delete a party
        function deleteParty(index) {
            console.log('Deleting party at index:', index);
            if (confirm('Are you sure you want to delete this party?')) {
                parties.splice(index, 1);
                updatePartiesTable();
                if (editingIndex === index) {
                    clearForm();
                    resetButtons();
                }
                showAlert('Party deleted successfully!', 'success');
            }
        }

        // Function to clear the form
        function clearForm() {
            console.log('Clearing form');
            $('#respondentForm')[0].reset();
            editingIndex = -1;
        }

        // Function to reset buttons
        function resetButtons() {
            console.log('Resetting buttons');
            $('#addParty').show();
            $('#updateParty').hide();
            $('#cancelEdit').hide();
        }

        // Function to show alert messages
        function showAlert(message, type = 'info') {
            console.log('Showing alert:', { message, type });
            const $alert = $(`
                <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                    ${message}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            `);
            
            $('#respondentForm').before($alert);
            
            // Remove alert after 3 seconds
            setTimeout(() => {
                $alert.alert('close');
            }, 3000);
        }

        // Initialize the table with empty state
        updatePartiesTable();

        // Initialize
        updateProgress();
        updateButtons();

        // Connect with lawyer button click handler
        $('#connectLawyer').on('click', function() {
            alert('Connecting you with the lawyer...');
        });

        // Chat with lawyer button click handler
        $('#chatLawyer').on('click', function() {
            $('#chatModal').modal('show');
        });

        // Send message button click handler
        $('#sendMessage').on('click', function() {
            const message = $('#chatInput').val().trim();
            if (message) {
                const $chatMessages = $('#chatMessages');
                $chatMessages.append(`
                    <div class="message user-message mb-2">
                        <div class="d-flex justify-content-end">
                            <div class="bg-primary text-white p-2 rounded">
                                ${message}
                            </div>
                        </div>
                    </div>
                `);
                $('#chatInput').val('');
                $chatMessages.scrollTop($chatMessages[0].scrollHeight);
                
                // Simulate lawyer response
                setTimeout(() => {
                    $chatMessages.append(`
                        <div class="message lawyer-message mb-2">
                            <div class="d-flex">
                                <div class="bg-light p-2 rounded">
                                    Thank you for your message. I'll get back to you shortly.
                                </div>
                            </div>
                        </div>
                    `);
                    $chatMessages.scrollTop($chatMessages[0].scrollHeight);
                }, 1000);
            }
        });

        // Handle enter key in chat input
        $('#chatInput').on('keypress', function(e) {
            if (e.which === 13) {
                $('#sendMessage').click();
            }
        });

        // Function to update payment section
        function updatePaymentSection() {
            // Generate and set case ID
            const caseId = generateCaseId();
            $('#caseId').val(caseId);

            // Clear previous values
            $('#payment-method').val('');
            $('#transactionId').val('');
        }

        // Function to generate case ID
        function generateCaseId() {
            const timestamp = new Date().getTime();
            const random = Math.floor(Math.random() * 10000);
            return `HC${timestamp}${random}`;
        }

        // Listen for pincode changes in complainant details
        $('#pincode').on('change', function() {
            const selectedPincode = $(this).val();
            if (selectedPincode) {
                // Set the jurisdiction pincode to match complainant pincode
                $('#jurisdictionPincode').val(selectedPincode).trigger('change');
                populateJurisdictionDetails(selectedPincode);
            }
        });

        // Listen for jurisdiction pincode changes
        $('#jurisdictionPincode').on('change', function() {
            const selectedPincode = $(this).val();
            if (selectedPincode) {
                populateJurisdictionDetails(selectedPincode);
            }
        });

        // Function to populate jurisdiction details
        function populateJurisdictionDetails(pincode) {
            const data = jurisdictionData[pincode];
            if (data) {
                $('#districtCourt').val(data.districtCourt);
                $('#jurisdictionCity').val(data.city);
                $('#courtAddress').val(data.address);
            }
        }

        // Handle advocate selection radio buttons
        $('input[name="advocateSelection"]').on('change', function() {
            const selectedOption = $(this).val();
            if (selectedOption === 'own') {
                $('#lawyerDropdownSection').show();
            } else {
                $('#lawyerDropdownSection').hide();
            }
        });

        // Initialize Select2 for lawyer dropdown
        $('#lawyerSelect').select2({
            width: '100%',
            dropdownAutoWidth: true
        });

        // Lawyer data mapping
        const lawyerData = {
            '1': {
                name: 'Adv. Rajesh Kumar',
                photo: 'https://randomuser.me/api/portraits/men/1.jpg',
                experience: '10 years',
                specialization: 'Specialist in Consumer Law',
                credentials: 'LL.M, Bar Council of India',
                successRate: '85%',
                casesHandled: '250+',
                languages: 'English, Hindi, Marathi',
                customerRating: 4.5,
                happyClaimRating: 4.8,
                responseTime: 'Within 2 hours'
            },
            '2': {
                name: 'Adv. Priya Sharma',
                photo: 'https://randomuser.me/api/portraits/women/1.jpg',
                experience: '8 years',
                specialization: 'Specialist in Consumer Protection',
                credentials: 'LL.M, Bar Council of India',
                successRate: '78%',
                casesHandled: '180+',
                languages: 'English, Hindi',
                customerRating: 4.3,
                happyClaimRating: 4.6,
                responseTime: 'Within 4 hours'
            },
            '3': {
                name: 'Adv. Amit Singh',
                photo: 'https://randomuser.me/api/portraits/men/2.jpg',
                experience: '12 years',
                specialization: 'Specialist in Consumer Law',
                credentials: 'LL.M, Bar Council of India',
                successRate: '82%',
                casesHandled: '300+',
                languages: 'English, Hindi, Punjabi',
                customerRating: 4.7,
                happyClaimRating: 4.9,
                responseTime: 'Within 1 hour'
            },
            '4': {
                name: 'Adv. Neha Gupta',
                photo: 'https://randomuser.me/api/portraits/women/2.jpg',
                experience: '9 years',
                specialization: 'Specialist in Consumer Protection',
                credentials: 'LL.M, Bar Council of India',
                successRate: '80%',
                casesHandled: '200+',
                languages: 'English, Hindi',
                customerRating: 4.4,
                happyClaimRating: 4.7,
                responseTime: 'Within 3 hours'
            },
            '5': {
                name: 'Adv. Vikram Patel',
                photo: 'https://randomuser.me/api/portraits/men/3.jpg',
                experience: '11 years',
                specialization: 'Specialist in Consumer Disputes',
                credentials: 'LL.M, Bar Council of India',
                successRate: '83%',
                casesHandled: '270+',
                languages: 'English, Hindi, Gujarati',
                customerRating: 4.6,
                happyClaimRating: 4.8,
                responseTime: 'Within 2 hours'
            },
            '6': {
                name: 'Adv. Meera Desai',
                photo: 'https://randomuser.me/api/portraits/women/3.jpg',
                experience: '7 years',
                specialization: 'Specialist in Consumer Rights',
                credentials: 'LL.M, Bar Council of India',
                successRate: '75%',
                casesHandled: '150+',
                languages: 'English, Hindi, Marathi',
                customerRating: 4.2,
                happyClaimRating: 4.5,
                responseTime: 'Within 5 hours'
            }
        };

        // Function to update lawyer details
        function updateLawyerDetails(lawyerId) {
            console.log('Updating lawyer details for ID:', lawyerId);
            const lawyer = lawyerData[lawyerId];
            if (!lawyer) {
                console.error('No lawyer found for ID:', lawyerId);
                return;
            }

            // Update photo and name
            $('#lawyerPhoto').attr('src', lawyer.photo);
            $('#lawyerFullName').text(lawyer.name);

            // Update professional details
            $('#lawyerSpecialization').text(lawyer.specialization);
            $('#lawyerCredentials').text(lawyer.credentials);
            $('#lawyerExperience').text(lawyer.experience);
            $('#lawyerSuccessRate').text(lawyer.successRate);
            $('#lawyerCasesHandled').text(lawyer.casesHandled);
            $('#lawyerLanguages').text(lawyer.languages);
            $('#lawyerResponseTime').text(lawyer.responseTime);

            // Update ratings
            $('#customerRating').html(generateStars(lawyer.customerRating));
            $('#happyClaimRating').html(generateStars(lawyer.happyClaimRating));

            // Update chat modal title
            $('#chatLawyerName').text(lawyer.name);

            console.log('Lawyer details updated successfully');
        }

        // Function to generate star ratings
        function generateStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) {
                    stars += '<i class="fas fa-star text-warning"></i>';
                } else if (i - 0.5 <= rating) {
                    stars += '<i class="fas fa-star-half-alt text-warning"></i>';
                } else {
                    stars += '<i class="far fa-star text-warning"></i>';
                }
            }
            return stars + ` <span class="ml-2">${rating}/5</span>`;
        }

        // Handle lawyer selection change
        $('#lawyerSelect').on('change', function() {
            const selectedLawyerId = $(this).val();
            console.log('Lawyer selection changed:', selectedLawyerId);
            if (selectedLawyerId) {
                updateLawyerDetails(selectedLawyerId);
            }
        });

        // Initialize with first lawyer's details
        updateLawyerDetails('1');
    });
</script>
</body>
</html>
